<html>
	<head>
		<title>Complex Functions</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		
		<style type="text/css">
			a {
				cursor: pointer;
			}
		</style>
		
		<link href="https://fonts.googleapis.com/css?family=Calibri:400,700,400italic,700italic" rel="stylesheet">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/5.5.0/math.min.js" type="text/javascript"></script>
		<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

		<!-- Google Analytics Code -->
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-103589215-2', 'auto');
		  ga('send', 'pageview');

		</script>
		<script type="application/ld+json">
			{
			  "@type": "Simulation",
			  "name": "Projectile",
			  "author": "Zihao",
			  "description": "A Visualization case referenced by Complex Functions Prajwal DSouza"
			  }
		</script>

		<script type="text/javascript">
			function displayText(detailinfo, additionalfunc) {
				if (typeof additionalfunc == 'undefined') {
					if (detailinfo == 'default') {
						detailinfo = 'Made using Math.js, MathJax to visualize projectile motion'
					}
					document.getElementById('infotext2').innerHTML = detailinfo
				}
			}
		</script>
		  <meta charset="UTF-8">
		  <meta name="author" content="Zihao">
		  <meta name="viewport" content="width=device-width, initial-scale=1.0">
		
	</head>
	<body style='margin:0px; display: block;'>
		<div id="containAll" style='margin:0px;width:100%; height: 100%; font-size: 0; display: inline-block;'> 
			<div id="controlTitleSection" style='margin:0px;width:30%; height: 70%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>
				<div id="titleH" style='margin:0px;width:100%; height: 25%;overflow: hidden;position: relative; z-index: 4; display: inline-block;'>
					<table width="100%" height='100%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: bold; font-family: Calibri; font-size: 1vw;">
						<tr>
							<td colspan="1" id='maintitle' style="text-align: center; vertical-align: middle; border-right: 0px solid black; font-size: 4vmin; font-weight: bold;  color: hsla(190, 100%, 50%, 1);">
								Projectile Motion <br/> <font style="font-size: 2.3vmin; font-weight: lighter; color: hsla(190, 0%, 60%, 1);">
								Kick ball </font><br/><font style="font-size: 2.3vmin; font-weight: lighter; color: hsla(190, 100%, 0%, 1);">
								Based on the handout<br/> in
								<a href="https://jinsanity07git.github.io/UWMnotebook/#/CE202/Dynamics?id=chapter-12-sections-4-6" target="_blank" style="text-decoration: none; color: hsla(210,100%,50%,1); "> in  Chapter12 Section 4-6 </a></font>
							</td>
						</tr>
					</table>
				</div>
				<div id="functioncontrols" style='margin:0px;width:100%; height: 75%;overflow: hidden;position: relative; z-index: 4; display: inline-block;'>
					<div id="functionchoice" style='margin:0px;width:100%; height: 20%;overflow: hidden;position: relative; z-index: 4; display: inline-block;'>
						<table width="100%" height='100%' style="border: 0px solid black; border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw; border-spacing: 0px;">
							<tr>
								<td colspan="1" rowspan="1"></td>
								<td colspan="9" rowspan="1" id='functiontitle' style="text-align: left; vertical-align: middle; border: 0px solid black; font-size: 2.5vmin; font-weight: lighter;">
									Function Input
								</td>
							</tr>
							<tr>
								<td colspan="1" rowspan="1"></td>
									<td colspan="2" rowspan="1" id='functionzeta' style="text-align: center; vertical-align: middle; border: 1px solid hsla(190, 0%,0%, 0.1); font-size: 2.3vmin; background-color: hsla(100,0%,50%, 0.1); cursor: pointer; border-bottom: 1px solid hsla(190, 0%, 0%, 1)" onmouseover="displayText('Projectile Motion.')" onmouseout="displayText('default')">
										Lab
									</td>


								<td colspan="1" rowspan="1"></td>
							</tr>
							<tr>		
								<td colspan="1" rowspan="1"></td>							
								<td colspan="5" rowspan="1">  &nbsp  A ball is kicked such that theta = </td>
								<td colspan="1" rowspan="1" id='initial1' style="text-align: center; vertical-align: middle; border: 0px solid black; font-size: 2vmin; font-weight: lighter;">
								<input id='initialtheta' value='30' style=" height: 80%; width: 100%; text-align: center; font-family: Calibri; font-size: 2vmin; font-weight: lighter; color: black;"></input>
								</td>
							</tr>
						</table>
					</div>
					<div id="sumtermtableH" style='margin:0px;width:100%; height: 40%;overflow: hidden;position: relative; z-index: 4; display: inline-block;'>
						<div id="displayforZetaH" style='margin:0px;width:100%; height: 100%;overflow: hidden;position: absolute; z-index: 4; display: inline-block; visibility: hidden;'>
							<table width="100%" height='100%' style="border: 0px solid black; border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw; border-spacing: 0px;">
								<tr>
									<td colspan="1" rowspan="1"></td>
									<td colspan="5" rowspan="1">Velocity at point A   &nbsp (ft/sec)  = </td>
									<td colspan="2" rowspan="1" id='initial' style="text-align: center; vertical-align: middle; border: 0px solid black; font-size: 2vmin; font-weight: lighter;">
										<input id='initialVA' value='10.0' style=" height: 50%; width: 100%; text-align: center; font-family: Calibri; font-size: 2vmin; font-weight: lighter; color: black;"></input>
										
									</td>
									<td colspan="1" rowspan="1"></td>

									<td colspan="1" rowspan="1"></td>
								</tr>

								<tr>
									<td colspan="1" rowspan="1"></td>
									<td colspan="9" rowspan="1" id='plotcriticalline' style="text-align: center; vertical-align: middle; border: 0px solid black; font-size: 2.1vmin; font-weight: lighter; border: 1px solid black; cursor: pointer;"  >
										Kicking
									</td>
									<td colspan="1" rowspan="1"></td>
								</tr>
								<tr></tr>
							</table>
						</div>
						<table id="summationTable" width="100%" height='100%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
							<tr></tr>
							<tr>
								<td colspan="1" rowspan="1"></td>
								<td colspan="9" rowspan="1" id='summationtitle' style="text-align: left; vertical-align: middle; border: 0px solid black; font-size: 2.3vmin; font-weight: lighter;">
									Summation Term
								</td>
							</tr>
							<tr>
								<td colspan="1" rowspan="2"></td>
								<td colspan="8" rowspan="2" id='inputfunction' style="text-align: center; vertical-align: middle; border-right: 0px solid black; font-size: 3vmin;" onmouseover="displayText('Type the function/summation term as text.')" onmouseout="displayText('default')">
									<input id='inputfunctiontext' value='1/(n^z)' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-family: Calibri; font-size: 2.3vmin; font-weight: lighter; color: black;"></input>

								</td>
								<td colspan="1" rowspan="2"></td>
							</tr>
							<tr>
							</tr>
							<tr>
							</tr>
							<tr>
							</tr>
							<tr id="holdindexrange" onmouseover="displayText('Input summation ranges for index n. ')" onmouseout="displayText('default')">
								<td colspan="1" rowspan="1"></td>
								
								<td colspan="2" id="nlowertext" style="text-align: center;">
									from (n = ) 
								</td>
								<td colspan="2" id="nlowervalue">
									<input id='nlowerinput' type="number" min = '0' step ='1' value='1' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-size: 1.8vmin; color: black;"></input>

								</td>
								<td colspan="2" id="nuppertext" style="text-align: center;">
									to (m = )
								</td>
								<td colspan="2" id="nuppervalue">
									<input id='nupperinput' type="number" min = '1' step ='1' value='10' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-size: 1.8vmin; color: black;"></input>
								</td>
								<td colspan="1" rowspan="1"></td>
							</tr>
							<tr>
							</tr>
						</table>
					</div>
					<div id="eqtableH" style='margin:0px;width:100%; height: 40%;overflow: hidden;position: relative; z-index: 4; display: inline-block;'>
						<table id="equationdisplaytable" style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw; height: 70%; width: 100%;">
							<tr onmouseover="displayText('Equation processed and displayed using MathJax (https://www.mathjax.org/)')" onmouseout="displayText('default')">
								<td colspan="1" rowspan="1"></td>
								<td colspan="8" id='equationdisplay' style="text-align: center; vertical-align: middle; border-right: 0px solid black; font-size: 2.7vmin; border: 1px solid hsla(210, 100%, 50%,0.2); overflow: auto;">
									$$  \\vec { \\mathbf { r } } = x \\hat { \\mathbf { i } } + y \\hat { \\mathbf { j } } + z \\hat { \\mathbf { k } }  $$
								</td>
								<td colspan="1" rowspan="1"></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
			<div id="complexplaneTableH" style='margin:0px;width:70%; height: 70%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>
				<table id="complexplaneinputTable" width="97%" height='97%' style="border: 0px solid hsla(190, 0%, 50%,0.2); border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw; position: absolute;">
					<tr>
						
						<td colspan="6" id='infotext' style="text-align: right; vertical-align: middle; border: 0px solid hsla(190, 0%, 50%,0.2); font-size: 2vmin; cursor: pointer; color: hsla(190, 100%, 0%, 1); font-weight: normal; height: 20%; " onmouseover="displayText('Input and output values of the function. Input is set by moving the cursor over the complex plane.')" onmouseout="displayText('default')">
							
						</td>
					</tr>
					<tr>
					
					</tr>
				</table>
				<table id="complexplaneTable" width="100%" height='97%' style="border: 0px solid hsla(190, 0%, 50%,0.2); border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
					<tr>
						<td>
							<table width="100%" height='100%' style="border: 1px solid hsla(190, 0%, 50%, 1); border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
								<tr>
									<td>
										<div id="complexplane" style='margin:0px;width:100%; height: 100%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>
											<div id="containcanvas" style='margin:0px;width:100%; height: 100%;overflow: hidden;background: hsla(300,100%,100%,0); cursor: auto; position: absolute; z-index: 0; opacity: 1;'>
												<canvas id='plotcanvas' height="100%" width="100%" style='position: absolute; z-index: 0; opacity: 1; width: 100%; height: 100%;'>
												</canvas>
											</div>
										</div>
									</td>
								</tr>	
							</table>
										
						</td>
					</tr>	
				</table>
			</div>
			<div id="presetFunctionsText" style='margin:0px;width:30%; height: 5%;overflow: hidden;position: relative;z-index: 4; display: inline-block; visibility: hidden;pointer-events: none;'>
				<table width="100%" height='100%' style="border: 0px solid black; border-collapse: separate; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw; border-spacing: 0px;">
					<tr>
						<td colspan="1"></td>
						<td colspan="8" id='presentextdisplay' style="text-align: center; vertical-align: middle; border: 1px solid hsla(190, 0%,0%, 0.1); font-size: 2.3vmin; background-color: hsla(100,0%,0%, 0); cursor: pointer;" onmouseover="displayText('Selection for Riemann Zeta Function Anaylsis.')" onmouseout="displayText('default')">
							Riemann Zeta
						</td>
						<td colspan="1"></td>
					</tr>
				</table>
			</div>
			<div id="player" style='margin:0px;width:70%; height: 20%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>

				<div id="playerholder" style='margin:0px;width:100%; height: 100%;overflow: hidden;position: relative;z-index: 3;'>
					<table width="100%" height='95%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
						<tr>	
							<td></td>
							<td colspan="12" rowspan="2" >
								The ball at A is kicked such that $$ \theta_A=30Â°. $$ If it strikes the ground at B having coordinates  x=15 ft , y= -9 ft, determine the speed at which it is kicked and the speed at which it strikes the ground.
							</td>
							<td></td>
							<td></td>
						</tr>
					</table>
				</div>
			</div>
			<div id="infodisplayH" style='margin:0px;width:30%; height: 5%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>
				<table width="100%" height='100%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
					<tr>	
						<td></td>
						<td colspan="8" id='infotext2' style="text-align: center; vertical-align: middle; border: 0px solid hsla(190, 0%, 50%,0.2); font-size: 2vmin; cursor: pointer; color: hsla(190, 100%, 0%, 1); font-weight: normal;">
							Made using Math.js, MathJax to visualize complex functions. 
						</td>
						<td></td>
					</tr>
					
				</table>
			</div>
			<div id="ntermdisplayHold" style='margin:0px;width:70%; height: 20%;overflow: hidden;position: relative;z-index: 4; display: inline-block;'>
				<div id="meshsettingdisplayHold" style='margin:0px;width:100%; height: 100%;overflow: hidden;position: absolute;z-index: 5; display: inline-block; opacity: 0; visibility: hidden; background-color: white;'>
					<table width="100%" height='100%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;">
						<tr>
							<td colspan="1" rowspan="1"></td>
							<td colspan="4" rowspan="1" id='meshsetdisplaytitle' style="text-align: left; vertical-align: middle; border: 0px solid black; font-size: 2.5vmin; font-weight: lighter;">
								Mesh Settings
							</td>
							<td colspan="15" rowspan="1" id='removemeshdisplaytitle' style="text-align: left; vertical-align: middle; border: 0px solid black; font-size: 2.2vmin; font-weight: lighter; color: hsla(190, 100%, 50%, 1); cursor: pointer;">
								Remove Mesh
							</td>
						</tr>
						<tr>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshrestext" style="text-align: center; font-size: 2vmin;">
								Mesh Resolution
							</td>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshcolstext" style="text-align: center; font-size: 2vmin;">
								Mesh Columns
							</td>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshrowstext" style="text-align: center; font-size: 2vmin;">
								Mesh Rows
							</td>
							
						</tr>
						<tr>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshresvalue">
								<input id='meshresinput' type="number" min = '10e-14' step ='10e-14' value='0.02' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-size: 1.8vmin; color: black;"></input>

							</td>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshcolsvalue">
								<input id='meshcolsinput' type="number" min = '1' step ='1' value='20' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-size: 1.8vmin; color: black;"></input>

							</td>
							<td colspan="1" rowspan="1"></td>
							<td colspan="5" id="meshrowsvalue">
								<input id='meshrowsinput' type="number" min = '0' step ='1' value='20' style="border: 1px solid hsla(190, 0%, 50%,0.2); height: 100%; width: 100%; text-align: center; font-size: 1.8vmin; color: black;"></input>

							</td>
						</tr>

						
					</table>
				</div>
				<table id="spectrumholder" width="100%" height='100%' style="border: 0px solid black; border-collapse: collapse; table-layout: fixed; font-weight: lighter; font-family: Calibri; font-size: 1vw;"  onmouseover="displayText('If the function is a summation, then the magnitude of each term is plotted. The color indicates the argument of the complex term with red for 180, blue of 0 and violet for -180.')" onmouseout="displayText('default')">
					<tr>
						<td colspan="1" rowspan="1"></td>
						<td colspan="19" rowspan="1" id='ntermdisplaytitle' style="text-align: left; vertical-align: middle; border: 0px solid black; font-size: 2.5vmin; font-weight: lighter;">
							Summation Term Magnitudes
						</td>
					</tr>
					<tr>	
						<td colspan="20" id='ntermdisplay' style="text-align: center; vertical-align: middle; border: 0px solid hsla(190, 0%, 50%,0.2); font-size: 2vmin; cursor: pointer; color: hsla(190, 100%, 0%, 1); font-weight: normal; position: relative;">
						</td>
					</tr>
					
				</table>


			</div>
			
		</div>


		<script type="text/javascript">

		fixedInnerWValue = window.innerWidth
		fixedInnerHValue = window.innerHeight

		if (fixedInnerWValue < fixedInnerHValue) {
			$('#infodisplayH').insertAfter('#controlTitleSection')
			$('#complexplaneTableH').insertBefore('#controlTitleSection')
			$('#player').insertBefore('#controlTitleSection')
			
			document.getElementById('controlTitleSection').style.height = '50%'
			document.getElementById('controlTitleSection').style.width = '60%'

			document.getElementById('complexplaneTableH').style.height = '70%'
			document.getElementById('complexplaneTableH').style.width = '100%'

			document.getElementById('presetFunctionsText').style.height = '0%'
			document.getElementById('presetFunctionsText').style.width = '0%'


			document.getElementById('player').style.height = '5%'
			document.getElementById('player').style.width = '100%'

			document.getElementById('infodisplayH').style.height = '50%'
			document.getElementById('infodisplayH').style.width = '40%'

			document.getElementById('ntermdisplayHold').style.height = '30%'
			document.getElementById('ntermdisplayHold').style.width = '100%'
			
		}

		


		darkmode = false

		if (darkmode) {
			document.body.style.background = 'black'
		}

		function graphToSvgY(value, graphymin, graphymax) {
			if (graphymin == graphymax) {
				graphymin = graphymin - 1
				graphymax = graphymax + 1
				console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphymax + ' and Min value : ' + graphymin)
			}
			if (graphymin > graphymax) {
				temp = graphymin
				graphymin = graphymax
				graphymax = temp
				console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphymax + ' and Min value : ' + graphymin)
			}
			y = ((-80)/(graphymax - graphymin))*(value - graphymin) + 90
			return y
		}

		function graphToScaledY(value, graphymin, graphymax, aspectratio) {
			if(aspectratio > 1) {
				if (graphymin == graphymax) {
					graphymin = graphymin - 1
					graphymax = graphymax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				if (graphymin > graphymax) {
					temp = graphymin
					graphymin = graphymax
					graphymax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				y = ((-80)/(graphymax - graphymin))*(value - graphymin) + 90
				
			}
			else {
				if (graphymin == graphymax) {
					graphymin = graphymin - 1
					graphymax = graphymax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				if (graphymin > graphymax) {
					temp = graphymin
					graphymin = graphymax
					graphymax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				aspectratio = 1/aspectratio
				vl = (100*(1 - aspectratio)/2) + (10*aspectratio)
				vh = (100*(aspectratio + 1)/2) - (10*aspectratio)
				y = ((vl - vh)/(graphymax - graphymin))*(value - graphymin) + vh
				// console.log(x)
				// console.log(v1, v2)
				// y = (((v2 - v1)/(100))*(y)) + v1
			}

			return y
		}

		function svgToGraphY(percentimeue, graphymin, graphymax, aspectratio) {
			if(aspectratio > 1) {
				if (graphymin == graphymax) {
					graphymin = graphymin - 1
					graphymax = graphymax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				if (graphymin > graphymax) {
					temp = graphymin
					graphymin = graphymax
					graphymax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}

				y = ((percentimeue - 90)*(graphymax - graphymin)/((-1)*80)) + graphymin
				
			}
			else {
				if (graphymin == graphymax) {
					graphymin = graphymin - 1
					graphymax = graphymax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				if (graphymin > graphymax) {
					temp = graphymin
					graphymin = graphymax
					graphymax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphymax + ' and Min value : ' + graphymin)
				}
				aspectratio = 1/aspectratio
				vl = (100*(1 - aspectratio)/2) + (10*aspectratio)
				vh = (100*(aspectratio + 1)/2) - (10*aspectratio)

				// y = ((vl - vh)/(graphymax - graphymin))*(value - graphymin) + vh
				y = (((percentimeue - vh)*(graphymax - graphymin))/(vl - vh)) + graphymin
				// console.log(x)
				// console.log(v1, v2)
				// y = (((v2 - v1)/(100))*(y)) + v1
			}

			return y
		}


		function graphToSvgX(value, graphxmin, graphxmax) {
			if (graphxmin == graphxmax) {
				graphxmin = graphxmin - 1
				graphxmax = graphxmax + 1
				console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
			}
			if (graphxmin > graphxmax) {
				temp = graphxmin
				graphxmin = graphxmax
				graphxmax = temp
				console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
			}
			x = ((80)/(graphxmax - graphxmin))*(value - graphxmin) + 10
			return x
		}

		function graphToScaledX(value, graphxmin, graphxmax, aspectratio) {
			if (aspectratio <= 1) {
				if (graphxmin == graphxmax) {
					graphxmin = graphxmin - 1
					graphxmax = graphxmax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				if (graphxmin > graphxmax) {
					temp = graphxmin
					graphxmin = graphxmax
					graphxmax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				x = ((80)/(graphxmax - graphxmin))*(value - graphxmin) + 10
			}
			else {
				if (graphxmin == graphxmax) {
					graphxmin = graphxmin - 1
					graphxmax = graphxmax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				if (graphxmin > graphxmax) {
					temp = graphxmin
					graphxmin = graphxmax
					graphxmax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				vl = (100*(1 - aspectratio)/2) + (10*aspectratio)
				vh = (100*(aspectratio + 1)/2) - (10*aspectratio)
				x = ((vh - vl)/(graphxmax - graphxmin))*(value - graphxmin) + vl
				// console.log(x)
				// console.log(v1, v2)
				// y - y1 = (y2 - y1)/(x2 - x1) * (x - x1)
				// x = (((v2 - v1)/(90))*(x - 10)) + v1
				// console.log(x)
				// console.log('_') 
			}
			return x
		}

		function svgToGraphX(percentimeue, graphxmin, graphxmax, aspectratio) {
			if (aspectratio <= 1) {
				if (graphxmin == graphxmax) {
					graphxmin = graphxmin - 1
					graphxmax = graphxmax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				if (graphxmin > graphxmax) {
					temp = graphxmin
					graphxmin = graphxmax
					graphxmax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}

				x = ((percentimeue - 10)*(graphxmax - graphxmin)/80) + graphxmin
			}
			else {
				if (graphxmin == graphxmax) {
					graphxmin = graphxmin - 1
					graphxmax = graphxmax + 1
					console.log('Conversion error, maximum value is equal to minimum value. Max value was raised by 1 and Min value was reduced by 1. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				if (graphxmin > graphxmax) {
					temp = graphxmin
					graphxmin = graphxmax
					graphxmax = temp
					console.log('Conversion error, maximum value less than minimum value. Values were swapped. Max value : ' + graphxmax + ' and Min value : ' + graphxmin)
				}
				vl = (100*(1 - aspectratio)/2) + (10*aspectratio)
				vh = (100*(aspectratio + 1)/2) - (10*aspectratio)

				// x = ((vh - vl)/(graphxmax - graphxmin))*(value - graphxmin) + vl

				x = ((percentimeue - vl)*(graphxmax - graphxmin)/(vh - vl)) + graphxmin

				// y - y1 = (y2 - y1)/(x2 - x1) * (x - x1)
				// x = (((v2 - v1)/(90))*(x - 10)) + v1
				 
			}
			return x
		}

		function isInt(n){
			return Number(n) === n && n % 1 === 0;
		}

		function isFloat(n){
			return Number(n) === n && n % 1 !== 0;
		}

		function gridtickvalues(valmin, valmax, ticksexpected) {
			expstring = ((valmax - valmin)/ticksexpected).toExponential()
			majorgridorder = parseFloat(Math.pow(10 , expstring.slice(expstring.indexOf('e') + 1)))
			
			if (expstring.indexOf('.') != -1) {
				majorgriddivision = parseFloat(expstring.slice(0, expstring.indexOf('.'))*majorgridorder)	
			}
			else {
				majorgriddivision = parseFloat(expstring.slice(0, expstring.indexOf('e'))*majorgridorder)
			}
			

			integerchoices = [1,2,5,10]
			for(choice = 0; choice < integerchoices.length - 1; choice++) {
				if (majorgriddivision < integerchoices[choice + 1]*majorgridorder) {
					majorgriddivisionchoice = majorgridorder*integerchoices[choice]
					break
				}
			}

			if(valmin > 0) {
				majorgridstart = Math.ceil(valmin/majorgriddivisionchoice)*majorgriddivisionchoice;
				majorgridstart = majorgridstart - majorgriddivisionchoice
			}
			else if(valmin < 0) {
				majorgridstart = Math.floor(valmin/majorgriddivisionchoice)*majorgriddivisionchoice;
			}
			else{
				majorgridstart = majorgriddivisionchoice;
			}

			// majorgridstart = majorgridstart - majorgriddivisionchoice
			// console.log(majorgridstart, (valmax + majorgriddivisionchoice), majorgriddivisionchoice)

			majortickvalues = []
			for(majoraxispoint = majorgridstart; majoraxispoint < (valmax + majorgriddivisionchoice); majoraxispoint = majoraxispoint + majorgriddivisionchoice) {
				majortickvalues.push(majoraxispoint)
			}

			return majortickvalues
		}

		function addGraph(parentdiv, name, gdata) {
			gdata = gdata || {}

			gdata.name = name || 'graph' + Math.random().toString()

			if (gdata.axislocationX != 0) {
				gdata.axislocationX = gdata.axislocationX || 0
			}
			else {
				gdata.axislocationX = 0
			}
			if (gdata.axislocationY != 0) {
				gdata.axislocationY = gdata.axislocationY || 0
			}
			else {
				gdata.axislocationY = 0
			}
			if (gdata.xmin != 0) {
				gdata.xmin = gdata.xmin || -1
			}
			else {
				gdata.xmin = 0
			}
			if (gdata.xmax != 0) {
				gdata.xmax = gdata.xmax || -1
			}
			else {
				gdata.xmax = 0
			}
			if (gdata.ymin != 0) {
				gdata.ymin = gdata.ymin || -1
			}
			else {
				gdata.ymin = 0
			}
			if (gdata.ymax != 0) {
				gdata.ymax = gdata.ymax || -1
			}
			else {
				gdata.ymax = 0
			}

			gdata.unitAspectRatio = gdata.unitAspectRatio || 'no'
			gdata.fixAxis = gdata.fixAxis || 'yaxis'
			gdata.fixAxisStretchCentrally = gdata.fixAxisStretchCentrally || 'no'


			gdata.xaxisvisibility = gdata.xaxisvisibility || 'yes'
			gdata.yaxisvisibility = gdata.yaxisvisibility || 'yes'

			gdata.xaxislabelvisibility = gdata.xaxislabelvisibility || 'yes' 
			gdata.yaxislabelvisibility = gdata.yaxislabelvisibility || 'yes'
			
			gdata.xmajorgridlinesvisibility = gdata.xmajorgridlinesvisibility || 'yes'
			gdata.ymajorgridlinesvisibility = gdata.ymajorgridlinesvisibility || 'yes'

			var svgElement = document.createElementNS("http://www.w3.org/2000/svg", 'svg');
			svgElement.setAttribute('height',"100%");
			svgElement.setAttribute('width', '100%');
			svgElement.setAttribute('viewBox',"0 0 100 100")
			// svgElement.setAttribute('preserveAspectRatio',"none")
			svgElement.setAttribute('id', name)
			svgElement.style.position = "absolute";
			svgElement.style.left = '0%'
			svgElement.style.top = '0%'
			parentdiv.appendChild(svgElement)
			gdata.svgElement = svgElement
			gdata.parentElement = parentdiv

			gdata.fontSize = gdata.fontSize || 5

			gdata.gridlinenumber = gdata.gridlinenumber || 10
			ticks = gdata.gridlinenumber

			gdata.parentW = parentdiv.offsetWidth
			gdata.parentH = parentdiv.offsetHeight

			aratio = parentdiv.offsetWidth/parentdiv.offsetHeight

			if (gdata.unitAspectRatio == 'yes') {
				if (gdata.fixAxis == 'yaxis') {
					if (gdata.fixAxisStretchCentrally == 'yes') {
						centre = (gdata.xmax + gdata.xmin)/2
						gdata.xmin = centre - ((gdata.ymax - gdata.ymin)*aratio/2)
						gdata.xmax = centre + ((gdata.ymax - gdata.ymin)*aratio/2)
					}
					else {
						gdata.xmax = gdata.xmin + (gdata.ymax - gdata.ymin)*aratio
					}
					
				}
				else {
					if (gdata.fixAxisStretchCentrally == 'yes') {
						centre = (gdata.ymax + gdata.ymin)/2
						gdata.ymin = centre - ((gdata.xmax - gdata.xmin)*aratio/2)
						gdata.ymax = centre + ((gdata.xmax - gdata.xmin)*aratio/2)
					}
					else {
						gdata.ymax = gdata.ymin + (gdata.xmax - gdata.xmin)*aratio	
					}
					
				}
			}



			gdata.yaxisthickness = gdata.yaxisthickness || 0.5
			gdata.yaxiscolor = gdata.yaxiscolor || 'hsla(0, 50%, 0%, 1)'


			if (gdata.yaxisvisibility == 'yes') {
				var lineElement = document.createElementNS("http://www.w3.org/2000/svg", 'line');
				lineElement.setAttribute('x1', graphToScaledX(gdata.axislocationX, gdata.xmin, gdata.xmax, aratio) + '%');
				lineElement.setAttribute('y1', graphToScaledY(gdata.ymax, gdata.ymin, gdata.ymax, aratio) + '%');
				lineElement.setAttribute('vector-effect','non-scaling-stroke');
				lineElement.setAttribute('x2', graphToScaledX(gdata.axislocationX, gdata.xmin, gdata.xmax, aratio) + '%')
				lineElement.setAttribute('y2', graphToScaledY(gdata.ymin, gdata.ymin, gdata.ymax, aratio) + '%');
				lineElement.setAttribute('id', gdata.name + '-yaxis')
				lineElement.style.stroke = gdata.yaxiscolor
				lineElement.style.strokeWidth = gdata.yaxisthickness + '%';
				gdata.yaxisElement = lineElement
				svgElement.appendChild(lineElement);
			}

			gdata.xaxisthickness = gdata.xaxisthickness || 0.5
			gdata.xaxiscolor = gdata.xaxiscolor || 'hsla(0, 50%, 0%, 1)'

			
			if (gdata.xaxisvisibility == 'yes') {
				var lineElement = document.createElementNS("http://www.w3.org/2000/svg", 'line');
				lineElement.setAttribute('x1', graphToScaledX(gdata.xmin, gdata.xmin, gdata.xmax, aratio) + '%');
				lineElement.setAttribute('y1', graphToScaledY(gdata.axislocationY, gdata.ymin, gdata.ymax, aratio) + '%');
				lineElement.setAttribute('vector-effect','non-scaling-stroke');
				lineElement.setAttribute('x2', graphToScaledX(gdata.xmax, gdata.xmin, gdata.xmax, aratio) + '%')
				lineElement.setAttribute('y2', graphToScaledY(gdata.axislocationY, gdata.ymin, gdata.ymax, aratio) + '%');
				lineElement.setAttribute('id', gdata.name + '-xaxis')
				lineElement.style.stroke = gdata.xaxiscolor
				lineElement.style.strokeWidth = gdata.xaxisthickness + '%';
				gdata.xaxisElement = lineElement
				svgElement.appendChild(lineElement);
			}


			gdata.xmajorgridcolor = gdata.xmajorgridcolor || 'hsla(190, 0%, 50%, 1)'
			gdata.xmajorgridthickness = gdata.xmajorgridthickness || 0.3

			gdata.xmajorgridlinesextension = gdata.xmajorgridlinesextension || 'yes'
			gdata.ymajorgridlinesextension = gdata.ymajorgridlinesextension || 'yes'
			
			if (gdata.xmajorgridlinesvisibility == 'yes') {
				xmajortickvalues = gridtickvalues(gdata.xmin, gdata.xmax, ticks)
				gdata.xmajorgridElements = []
				for (m = 0; m < xmajortickvalues.length; m++) {
					ticklocation = xmajortickvalues[m]
					var lineElement = document.createElementNS("http://www.w3.org/2000/svg", 'line');
					ylength = (gdata.ymax - gdata.ymin)
					if (gdata.xmajorgridlinesextension == 'yes') {
						lineElement.setAttribute('x1', graphToScaledX(ticklocation, gdata.xmin, gdata.xmax, aratio) + '%');
						lineElement.setAttribute('y1', graphToScaledY(gdata.ymin - (ylength)/2, gdata.ymin, gdata.ymax, aratio) + '%');
						lineElement.setAttribute('vector-effect','non-scaling-stroke');
						lineElement.setAttribute('x2', graphToScaledX(ticklocation, gdata.xmin, gdata.xmax, aratio) + '%')
						lineElement.setAttribute('y2', graphToScaledY(gdata.ymax + (ylength)/2, gdata.ymin, gdata.ymax, aratio) + '%');
						
					}
					else {
						lineElement.setAttribute('x1', graphToScaledX(ticklocation, gdata.xmin, gdata.xmax, aratio) + '%');
						lineElement.setAttribute('y1', graphToScaledY(gdata.ymin, gdata.ymin, gdata.ymax, aratio) + '%');
						lineElement.setAttribute('vector-effect','non-scaling-stroke');
						lineElement.setAttribute('x2', graphToScaledX(ticklocation, gdata.xmin, gdata.xmax, aratio) + '%')
						lineElement.setAttribute('y2', graphToScaledY(gdata.ymax, gdata.ymin, gdata.ymax, aratio) + '%');
						lineElement.setAttribute('id', gdata.name + '-xmajorgridline-' + m)
					}
					lineElement.style.stroke = gdata.xmajorgridcolor
					lineElement.style.strokeWidth = gdata.xmajorgridthickness + '%';
					gdata.xmajorgridElements.push(lineElement)
					svgElement.appendChild(lineElement);
				}
				gdata.xmajorgridticks = xmajortickvalues
			}

			gdata.ymajorgridcolor = gdata.ymajorgridcolor || 'hsla(190, 0%, 50%, 1)'
			gdata.ymajorgridthickness = gdata.ymajorgridthickness || 0.3


			if (gdata.ymajorgridlinesvisibility == 'yes') {
				ymajortickvalues = gridtickvalues(gdata.ymin, gdata.ymax, ticks)
				gdata.ymajorgridElements = []
				for (m = 0; m < ymajortickvalues.length; m++) {
					ticklocation = ymajortickvalues[m]
					var lineElement = document.createElementNS("http://www.w3.org/2000/svg", 'line');
					xlength = (gdata.xmax - gdata.xmin)
					if (gdata.ymajorgridlinesextension == 'yes') {
						lineElement.setAttribute('x1', graphToScaledX((gdata.xmin) - xlength/2, gdata.xmin, gdata.xmax, aratio) + '%');
						lineElement.setAttribute('y1', graphToScaledY(ticklocation, gdata.ymin, gdata.ymax, aratio) + '%');
						lineElement.setAttribute('vector-effect','non-scaling-stroke');
						lineElement.setAttribute('x2', graphToScaledX(gdata.xmax + (xlength/2), gdata.xmin, gdata.xmax, aratio) + '%')
						lineElement.setAttribute('y2', graphToScaledY(ticklocation, gdata.ymin, gdata.ymax, aratio) + '%');
					}
					else {
						lineElement.setAttribute('x1', graphToScaledX(gdata.xmin, gdata.xmin, gdata.xmax, aratio) + '%');
						lineElement.setAttribute('y1', graphToScaledY(ticklocation, gdata.ymin, gdata.ymax, aratio) + '%');
						lineElement.setAttribute('vector-effect','non-scaling-stroke');
						lineElement.setAttribute('x2', graphToScaledX(gdata.xmax, gdata.xmin, gdata.xmax, aratio) + '%')
						lineElement.setAttribute('y2', graphToScaledY(ticklocation, gdata.ymin, gdata.ymax, aratio) + '%');
					}
					lineElement.setAttribute('id', gdata.name + '-ymajorgridline-' + m)
					lineElement.style.stroke = gdata.ymajorgridcolor
					lineElement.style.strokeWidth = gdata.ymajorgridthickness + '%';
					gdata.ymajorgridElements.push(lineElement)
					svgElement.appendChild(lineElement);
				}
				gdata.ymajorgridticks = ymajortickvalues
			}

			

			gdata.ymajorgridlabelvisibility = gdata.ymajorgridlabelvisibility || 'yes'
			gdata.ymajorgridlabelcolor = gdata.ymajorgridlabelcolor || 'hsla(190, 0%, 50%, 1)'


			gdata.ymajorgridlabelshift = gdata.ymajorgridlabelshift || 0.1
			gdata.xmajorgridlabelshift = gdata.xmajorgridlabelshift || 0.1

			gdata.xmajorgridlabelvisibility = gdata.xmajorgridlabelvisibility || 'yes'
			gdata.xmajorgridlabelcolor = gdata.xmajorgridlabelcolor || 'hsla(190, 0%, 50%, 1)'



			gdata.xlabelexclusionsstart = gdata.xlabelexclusionsstart || 0
			gdata.xlabelexclusionsend = gdata.xlabelexclusionsend || 0

			gdata.ylabelexclusionsstart = gdata.ylabelexclusionsstart || 0
			gdata.ylabelexclusionsend = gdata.ylabelexclusionsend || 0


			gdata.isComplexPlane = gdata.isComplexPlane || 'no'


			if (gdata.ymajorgridlabelvisibility == 'yes') {
				gdata.ymajorlabelsElements = []
				ymajortickvalues = gridtickvalues(gdata.ymin, gdata.ymax, ticks)
				labelylocationX = gdata.axislocationX
				if (graphToScaledX(gdata.axislocationX, gdata.xmin, gdata.xmax, aratio) < 0) {
					labelylocationX = gdata.xmin
				}
				if (graphToScaledX(gdata.axislocationX, gdata.xmin, gdata.xmax, aratio) > 100) {
					labelylocationX = gdata.xmax
				}
				for (m = gdata.ylabelexclusionsstart; m < ymajortickvalues.length - gdata.ylabelexclusionsend; m++) {
					ticklocation = ymajortickvalues[m]

					var textElement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
					if(isInt(ticklocation)) {
						if (gdata.isComplexPlane == 'yes') {
							// textElement.innerHTML = ticklocation + 'i'
							textElement.innerHTML = ticklocation
						}
					}
					else {
						expstring = ticklocation.toExponential().toString()
						order = (expstring.slice(expstring
							.indexOf('e') + 1)*(-1))
						if (parseFloat(order) < -1) {
							ticklocation = ticklocation.toExponential(0)	
						}
						else {
							ticklocation = ticklocation.toFixed(2)
						}
						textElement.innerHTML = ticklocation
						if(ticklocation == 0) {
							textElement.innerHTML = 0
						}
						if (gdata.isComplexPlane == 'yes') {
							// textElement.innerHTML = ticklocation + 'i'
							textElement.innerHTML = ticklocation 
						}

					}

					textElement.setAttribute('x', graphToScaledX(labelylocationX, gdata.xmin, gdata.xmax, aratio) + 0.5 + gdata.ymajorgridlabelshift + '%');
					textElement.setAttribute('y',graphToScaledY(ticklocation, gdata.ymin, gdata.ymax, aratio) + 0.5 + '%');
					textElement.setAttribute('id',name + '-yticklabel-' + m)
					textElement.style.fontSize = gdata.fontSize
					textElement.style.fontFamily = 'Calibri'
					textElement.style.fill = gdata.ymajorgridlabelcolor
					svgElement.appendChild(textElement);

					gdata.ymajorlabelsElements.push(textElement)
					
				}
			}


			if (gdata.xmajorgridlabelvisibility == 'yes') {
				gdata.xmajorlabelsElements = []
				xmajortickvalues = gridtickvalues(gdata.xmin, gdata.xmax, ticks)
				labelxlocationY = gdata.axislocationY
				if (graphToScaledY(gdata.axislocationY, gdata.ymin, gdata.ymax, aratio) < 0) {
					labelxlocationY = gdata.ymin
				}
				if (graphToScaledY(gdata.axislocationY, gdata.ymin, gdata.ymax, aratio) > 100) {
					labelxlocationY = gdata.ymax
				}


				for (m = gdata.xlabelexclusionsstart; m < xmajortickvalues.length - gdata.xlabelexclusionsend; m++) {
					ticklocation = xmajortickvalues[m]

					var textElement = document.createElementNS("http://www.w3.org/2000/svg", 'text');

					if(isInt(ticklocation)) {
						textElement.innerHTML = ticklocation
					}
					else {

						expstring = ticklocation.toExponential().toString()
						order = (expstring.slice(expstring.indexOf('e') + 1)*(-1))
						if (parseFloat(order) < -1) {
							ticklocation = ticklocation.toExponential(0)	
						}
						else {
							ticklocation = ticklocation.toFixed(2)
						}
						textElement.innerHTML = ticklocation
						if(ticklocation == 0) {
							textElement.innerHTML = 0
						}

					}

					textElement.setAttribute('x', graphToScaledX(ticklocation, gdata.xmin, gdata.xmax, aratio) - 1 + '%');
					textElement.setAttribute('y',graphToScaledY(labelxlocationY, gdata.ymin, gdata.ymax, aratio) + 2 + gdata.xmajorgridlabelshift + '%');
					textElement.setAttribute('id',name + '-xticklabel-' + m)
					textElement.style.fontSize = gdata.fontSize
					textElement.style.fontFamily = 'Calibri'
					textElement.style.fill = gdata.ymajorgridlabelcolor
					svgElement.appendChild(textElement);
					
					gdata.xmajorlabelsElements.push(textElement)
					
				}
			}


			gdata.xaxislabel = gdata.xaxislabel || 'x axis'
			gdata.yaxislabel = gdata.yaxislabel || 'y axis'

			gdata.xaxislabelshift = gdata.xaxislabelshift || 2
			gdata.yaxislabelshift = gdata.yaxislabelshift || 2

			if (gdata.xaxislabelvisibility == 'yes') {
				var textElement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
				textElement.innerHTML = gdata.xaxislabel 
				textElement.setAttribute('x', graphToScaledX(gdata.xmax, gdata.xmin, gdata.xmax, aratio) + gdata.xaxislabelshift + '%');
				textElement.setAttribute('y',graphToScaledY(gdata.axislocationY, gdata.ymin, gdata.ymax, aratio) + 1 + '%');
				textElement.setAttribute('id',name + '-xaxislabel')
				textElement.style.fontSize = gdata.fontSize
				textElement.style.fontFamily = 'Calibri'
				
				svgElement.appendChild(textElement);
				gdata.xaxislabelElement = textElement
				
			}


			if (gdata.yaxislabelvisibility == 'yes') {
				var textElement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
				textElement.innerHTML = gdata.yaxislabel 
				textElement.setAttribute('x', graphToScaledX(gdata.axislocationX, gdata.xmin, gdata.xmax, aratio) + 0 + '%');
				textElement.setAttribute('y',graphToScaledY(gdata.ymax, gdata.ymin, gdata.ymax, aratio) - gdata.yaxislabelshift + '%');
				textElement.setAttribute('id',name + '-yaxislabel')
				textElement.style.fontSize = gdata.fontSize
				textElement.style.fontFamily = 'Calibri'
				
				svgElement.appendChild(textElement);
				gdata.yaxislabelElement = textElement
				
			}

			gdata.lineData = {}
			gdata.circleData = {}
			gdata.pointData = {}
			gdata.ellipseData = {}
			gdata.rectData = {}
			gdata.textData = {}
			gdata.pathData = {}

			gdata.aspectratio = aratio



			graphData[name] = gdata
			return JSON.parse(JSON.stringify(gdata));
		}

		function getGraphCursorLocation(cursorpercent, graphname) {
			gdata = graphData[graphname]

			graphEl = document.getElementById(gdata.name)

			valx = svgToGraphX(cursorpercent[0], gdata.xmin, gdata.xmax, gdata.aspectratio)
			valy = svgToGraphY(cursorpercent[1], gdata.ymin, gdata.ymax, gdata.aspectratio)

			return [valx, valy]
		}


		function addLine(graphname, linename, lineoptions) {
			gdata = graphData[graphname]
			lineoptions = lineoptions || {}

			aratio = gdata.aspectratio

			lineoptions.x1 = parseFloat(lineoptions.x1.toString() || 0)
			lineoptions.y1 = parseFloat(lineoptions.y1.toString() || 0)
			lineoptions.x2 = parseFloat(lineoptions.x2.toString() || 0.5)
			lineoptions.y2 = parseFloat(lineoptions.y2.toString() || 0.5)
			lineoptions.name = linename || uid

			lineoptions.strokedasharray = lineoptions.strokedasharray || ""

			// console.log((0).toString() || 0.5)

			lineoptions.strokewidth = lineoptions.strokewidth || 1
			lineoptions.linecolor = lineoptions.linecolor || 'hsla(190, 100%, 50%, 1)'

			var lineElement = document.createElementNS("http://www.w3.org/2000/svg", 'line');
			lineElement.setAttribute('x1', graphToScaledX(lineoptions.x1, gdata.xmin, gdata.xmax, aratio) + '%');
			lineElement.setAttribute('y1', graphToScaledY(lineoptions.y1, gdata.ymin, gdata.ymax, aratio) + '%');
			lineElement.setAttribute('x2', graphToScaledX(lineoptions.x2, gdata.xmin, gdata.xmax, aratio) + '%')
			lineElement.setAttribute('y2', graphToScaledY(lineoptions.y2, gdata.ymin, gdata.ymax, aratio) + '%');
			lineElement.setAttribute('stroke-dasharray', lineoptions.strokedasharray);
			
			lineElement.setAttribute('id', graphname + '-line-' + linename)
			uid = uid + 1
			lineElement.setAttribute('vector-effect','non-scaling-stroke');
			lineElement.style.stroke = lineoptions.linecolor
			lineElement.style.strokeWidth = lineoptions.strokewidth + '%';
			gdata.svgElement.appendChild(lineElement);

			graphData[graphname].lineData[linename] = [lineElement, lineoptions]
			return [lineElement, lineoptions]
		}

		function addPath(graphname, pathname, pathoptions) {
			gdata = graphData[graphname]
			pathoptions = pathoptions || {}

			aratio = gdata.aspectratio

			pathoptions.points = pathoptions.points || [[0, 1], [1, 0]]

			pathstring = 'M'

			for (pth = 0; pth < pathoptions.points.length; pth++) {
				if (pth == 0) {
					pathstring = pathstring + graphToScaledX(pathoptions.points[pth][0], gdata.xmin, gdata.xmax, aratio) + ' ' + graphToScaledY(pathoptions.points[pth][1], gdata.ymin, gdata.ymax, aratio) + ' '
				}
				else {
					pathstring = pathstring + 'L' + graphToScaledX(pathoptions.points[pth][0], gdata.xmin, gdata.xmax, aratio) + ' ' + graphToScaledY(pathoptions.points[pth][1], gdata.ymin, gdata.ymax, aratio) + ' '
				}
				
			}

			

			pathoptions.name = pathname || uid
			// console.log((0).toString() || 0.5)

			pathoptions.strokewidth = pathoptions.strokewidth || 1
			pathoptions.pathcolor = pathoptions.pathcolor || 'hsla(190, 100%, 50%, 1)'

			var pathElement = document.createElementNS("http://www.w3.org/2000/svg", 'path');
			pathElement.setAttribute('d', pathstring);
			pathElement.setAttribute('id', graphname + '-path-' + pathname)
			uid = uid + 1
			pathElement.style.stroke = pathoptions.pathcolor
			pathElement.style.fill = 'none'
			pathElement.style.strokeWidth = pathoptions.strokewidth + '%';
			gdata.svgElement.appendChild(pathElement);

			graphData[graphname].pathData[pathname] = [pathElement, pathoptions]
			return [pathElement, pathoptions]
		}

		function updatePath(graphname, pathname, npathpoints) {

			gdata = graphData[graphname]
			aratio = gdata.aspectratio

			pathoptions = gdata.pathData[pathname][1]
			pathElement = gdata.pathData[pathname][0]

			pathoptions.points = npathpoints || pathoptions.points

			pathstring = 'M'

			for (pth = 0; pth < pathoptions.points.length; pth++) {
				if (pth == 0) {
					pathstring = pathstring + graphToScaledX(pathoptions.points[pth][0], gdata.xmin, gdata.xmax, aratio) + ' ' + graphToScaledY(pathoptions.points[pth][1], gdata.ymin, gdata.ymax, aratio) + ' '
				}
				else {
					pathstring = pathstring + 'L' + graphToScaledX(pathoptions.points[pth][0], gdata.xmin, gdata.xmax, aratio) + ' ' + graphToScaledY(pathoptions.points[pth][1], gdata.ymin, gdata.ymax, aratio) + ' '
				}
				
			}

			pathElement.setAttribute('d', pathstring);
			
			graphData[graphname].pathData[pathname] = [pathElement, pathoptions]

			return [pathElement, pathoptions]
		}


		function updateLine(graphname, linename, linevalues) {

			gdata = graphData[graphname]
			aratio = gdata.aspectratio

			lineoptions = gdata.lineData[linename][1]
			lineElement = gdata.lineData[linename][0]
			
			if (linevalues.x1 != 0) {
				lineoptions.x1 = linevalues.x1 || lineoptions.x1	
			}
			else {
				lineoptions.x1 = linevalues.x1
			}


			if (linevalues.y1 != 0) {
				lineoptions.y1 = linevalues.y1 || lineoptions.y1	
			}
			else {
				lineoptions.y1 = linevalues.y1
			}


			if (linevalues.x2 != 0) {
				lineoptions.x2 = linevalues.x2 || lineoptions.x2	
			}
			else {
				lineoptions.x2 = linevalues.x2
			}


			if (linevalues.y2 != 0) {
				lineoptions.y2 = linevalues.y2 || lineoptions.y2	
			}
			else {
				lineoptions.y2 = linevalues.y2
			}

			lineElement.setAttribute('x1', graphToScaledX(lineoptions.x1, gdata.xmin, gdata.xmax, aratio) + '%');
			lineElement.setAttribute('y1', graphToScaledY(lineoptions.y1, gdata.ymin, gdata.ymax, aratio) + '%');
			lineElement.setAttribute('x2', graphToScaledX(lineoptions.x2, gdata.xmin, gdata.xmax, aratio) + '%')
			lineElement.setAttribute('y2', graphToScaledY(lineoptions.y2, gdata.ymin, gdata.ymax, aratio) + '%');
			
			
			graphData[graphname].lineData[linename] = [lineElement, lineoptions]
		}


		function distanceBTWgraphToSvg(p1, p2, xmin, xmax, ymin, ymax, aspectratio) {
			pt1 = [graphToScaledX(p1[0], xmin, xmax, aspectratio), graphToScaledY(p1[1], ymin, ymax, aspectratio)]
			pt2 = [graphToScaledX(p2[0], xmin, xmax, aspectratio), graphToScaledY(p2[1], ymin, ymax, aspectratio)]

			return Math.pow(Math.pow(pt1[0] - pt2[0], 2) + Math.pow(pt1[1] - pt2[1], 2), 0.5)
		}


		function addCircle(graphname, circlename, circleoptions) {
			gdata = graphData[graphname]
			circleoptions = circleoptions || {}
			aratio = gdata.aspectratio

			circleoptions.x = circleoptions.x || 0.3
			circleoptions.y = circleoptions.y || 0.3
			circleoptions.radius = circleoptions.radius || 0.1
			circleoptions.name = circlename || uid

			circleoptions.stroke = circleoptions.stroke || 'hsla(190, 100%, 50%, 0.5)'
			circleoptions.strokewidth = circleoptions.strokewidth || 0.1
			

			circleoptions.circlecolor = circleoptions.circlecolor || 'hsla(190, 100%, 50%, 1)'

			rx = distanceBTWgraphToSvg([0,0],[circleoptions.radius, 0], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			ry = distanceBTWgraphToSvg([0,0],[0, circleoptions.radius], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			
			var circleElement = document.createElementNS("http://www.w3.org/2000/svg", 'ellipse');
			circleElement.setAttribute('cx', graphToScaledX(circleoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			circleElement.setAttribute('cy', graphToScaledY(circleoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			circleElement.setAttribute('rx', rx + '%')
			circleElement.setAttribute('ry', ry + '%');
			circleElement.setAttribute('id', graphname + '-circle-' + circlename)
			uid = uid + 1
			circleElement.setAttribute('vector-effect','non-scaling-stroke');
			circleElement.style.fill = circleoptions.circlecolor
			circleElement.style.strokeWidth = circleoptions.strokewidth + '%';
			circleElement.style.stroke = circleoptions.stroke;
			gdata.svgElement.appendChild(circleElement);

			graphData[graphname].circleData[circlename] = [circleElement, circleoptions]
		}

		function addEllipse(graphname, ellipsename, ellipseoptions) {
			gdata = graphData[graphname]

			aratio = gdata.aspectratio

			ellipseoptions = ellipseoptions || {}

			ellipseoptions.x = parseFloat(ellipseoptions.x.toString() || 0)
			ellipseoptions.y = parseFloat(ellipseoptions.y.toString() || 0)
			ellipseoptions.rx = parseFloat(ellipseoptions.rx.toString() || 0.3)
			ellipseoptions.ry = parseFloat(ellipseoptions.ry.toString() || 8)
			ellipseoptions.name = ellipsename || uid

			ellipseoptions.stroke = ellipseoptions.stroke || 'hsla(190, 100%, 50%, 0.5)'
			ellipseoptions.strokewidth = ellipseoptions.strokewidth || 0.1
			
			ellipseoptions.ellipsecolor = ellipseoptions.ellipsecolor || 'hsla(190, 100%, 50%, 1)'

			rx = distanceBTWgraphToSvg([0,0],[ellipseoptions.rx, 0], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			ry = distanceBTWgraphToSvg([0,0],[0, ellipseoptions.ry], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			
			var ellipseElement = document.createElementNS("http://www.w3.org/2000/svg", 'ellipse');
			ellipseElement.setAttribute('cx', graphToScaledX(ellipseoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			ellipseElement.setAttribute('cy', graphToScaledY(ellipseoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			ellipseElement.setAttribute('rx', rx + '%')
			ellipseElement.setAttribute('ry', ry + '%');
			ellipseElement.setAttribute('id', graphname + '-ellipse-' + ellipsename)
			uid = uid + 1
			ellipseElement.setAttribute('vector-effect','non-scaling-stroke');
			ellipseElement.style.fill = ellipseoptions.ellipsecolor
			ellipseElement.style.strokeWidth = ellipseoptions.strokewidth + '%';
			ellipseElement.style.stroke = ellipseoptions.stroke;
			gdata.svgElement.appendChild(ellipseElement);

			graphData[graphname].ellipseData[ellipsename] = [ellipseElement, ellipseoptions]
		}

		function addText(graphname, textname, textoptions) {
			gdata = graphData[graphname]
			textoptions = textoptions || {}

			aratio = gdata.aspectratio

			textoptions.x = parseFloat(textoptions.x.toString() || 0)
			textoptions.y = parseFloat(textoptions.y.toString() || 0)
			textoptions.text = textoptions.text || ''
			textoptions.name = textname || uid

			textoptions.textAlign = textoptions.textAlign || 'left'
			textoptions.fontSize = textoptions.fontSize || 12
			
			textoptions.textcolor = textoptions.textcolor || 'hsla(190, 100%, 0%, 1)'
			
			var textElement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
			textElement.setAttribute('x', graphToScaledX(textoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			textElement.setAttribute('y', graphToScaledY(textoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			textElement.setAttribute('id', graphname + '-text-' + textname)
			uid = uid + 1
			textElement.setAttribute('vector-effect','non-scaling-stroke');
			textElement.style.fill = textoptions.textcolor
			textElement.innerHTML = textoptions.text
			textElement.style.fontFamily = 'Calibri'
			textElement.style.fontSize = textoptions.fontSize;
			if (textoptions.textAlign == 'center') {
				textElement.setAttribute('text-anchor','middle')
			}
			gdata.svgElement.appendChild(textElement);

			graphData[graphname].textData[textname] = [textElement, textoptions]
			return [textElement, textoptions]
		}

		function updateText(graphname, textname, updatetext) {
			gdata = graphData[graphname]

			aratio = gdata.aspectratio

			textoptions = gdata.textData[textname][1]
			textElement = gdata.textData[textname][0]

			textoptions.text = updatetext.text || textoptions.text
			textoptions.x = updatetext.x || textoptions.x
			textoptions.y = updatetext.y || textoptions.y
			textoptions.name = textname || uid

			textElement.innerHTML = textoptions.text
			textElement.setAttribute('x', graphToScaledX(textoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			textElement.setAttribute('y', graphToScaledY(textoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			
			
			graphData[graphname].textData[textname] = [textElement, textoptions]
			return [textElement, textoptions]
		}

		function addRectangle(graphname, rectname, rectoptions) {
			gdata = graphData[graphname]
			aratio = gdata.aspectratio
			rectoptions = rectoptions || {}

			rectoptions.x = parseFloat(rectoptions.x.toString() || 0)
			rectoptions.y = parseFloat(rectoptions.y.toString() || 0)
			rectoptions.w = parseFloat(rectoptions.w.toString() || 1)
			rectoptions.h = parseFloat(rectoptions.h.toString() || 1)
			rectoptions.name = rectname || uid

			rectoptions.stroke = rectoptions.stroke || 'hsla(190, 100%, 50%, 0.5)'
			rectoptions.strokewidth = rectoptions.strokewidth || 0.1
			rectoptions.strokedasharray = rectoptions.strokedasharray || ""

			
			rectoptions.rectcolor = rectoptions.rectcolor || 'hsla(190, 100%, 50%, 1)'

			rx = distanceBTWgraphToSvg([0,0],[rectoptions.w, 0], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			ry = distanceBTWgraphToSvg([0,0],[0, rectoptions.h], gdata.xmin, gdata.xmax, gdata.ymin, gdata.ymax, aratio)
			
			var rectElement = document.createElementNS("http://www.w3.org/2000/svg", 'rect');
			rectElement.setAttribute('x', graphToScaledX(rectoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			rectElement.setAttribute('y', graphToScaledY(rectoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			rectElement.setAttribute('width', rx + '%')
			rectElement.setAttribute('height', ry + '%');
			rectElement.setAttribute('id', graphname + '-rect-' + rectname)
			uid = uid + 1
			rectElement.setAttribute('vector-effect','non-scaling-stroke');
			rectElement.style.fill = rectoptions.rectcolor
			rectElement.style.strokeWidth = rectoptions.strokewidth + '%';
			rectElement.style.stroke = rectoptions.stroke;
			rectElement.setAttribute('stroke-dasharray', rectoptions.strokedasharray);

			gdata.svgElement.appendChild(rectElement);

			graphData[graphname].rectData[rectname] = [rectElement, rectoptions]

			return [rectElement, rectoptions]
		}



		function addPoint(graphname, pointname, pointoptions) {
			gdata = graphData[graphname]
			aratio = gdata.aspectratio

			pointoptions = pointoptions || {}

			if (pointoptions.x != 0) {
				pointoptions.x = pointoptions.x || 0.3	
			}
			if (pointoptions.y != 0) {
				pointoptions.y = pointoptions.y || 0.3	
			}
			// pointoptions.y = pointoptions.y || 0.3
			pointoptions.pointsize = pointoptions.pointsize || 0.7
			pointoptions.name = pointname || uid

			pointoptions.pointcolor = pointoptions.pointcolor || 'hsla(190, 100%, 50%, 1)'
			
			var pointElement = document.createElementNS("http://www.w3.org/2000/svg", 'ellipse');
			pointElement.setAttribute('cx', graphToScaledX(pointoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
			pointElement.setAttribute('cy', graphToScaledY(pointoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');
			pointElement.setAttribute('rx', pointoptions.pointsize + '%')
			pointElement.setAttribute('ry', pointoptions.pointsize + '%');
			pointElement.setAttribute('id', graphname + '-point-' + pointname)
			uid = uid + 1
			pointElement.setAttribute('vector-effect','non-scaling-stroke');
			pointElement.style.fill = pointoptions.pointcolor
			gdata.svgElement.appendChild(pointElement);

			graphData[graphname].pointData[pointname] = [pointElement, pointoptions]
			return [pointElement, pointoptions]
		}

		// function updatePoint(graphname, pointname, xvalue, yvalue) {
		// 	pointElement = document.getElementById(graphname + '-point-' + pointname)
			
		// 	gdata = graphData[graphname]
		// 	aratio = gdata.aspectratio

		// 	pointoptions = graphData[graphname].pointData[pointname][1]

		// 	pointoptions.x = xvalue
		// 	pointoptions.y = yvalue
			
			
		// 	pointElement.setAttribute('cx', graphToScaledX(pointoptions.x, gdata.xmin, gdata.xmax, aratio) + '%');
		// 	pointElement.setAttribute('cy', graphToScaledY(pointoptions.y, gdata.ymin, gdata.ymax, aratio) + '%');

		// 	graphData[graphname].pointData[pointname] = [pointElement, pointoptions]
		// }

		function removePoint(graphname, pointname) {
			pointElement = document.getElementById(graphname + '-point-' + pointname)
			
			pointElement.outerHTML = "";
			delete graphData[graphname].pointData[pointname]
		}

		function removeLine(graphname, linename) {
			lineElement = document.getElementById(graphname + '-line-' + linename)
			lineElement.outerHTML = "";
			delete graphData[graphname].lineData[linename]
		}

		function removePath(graphname, pathname) {
			pathElement = document.getElementById(graphname + '-path-' + pathname)
			pathElement.outerHTML = "";
			delete graphData[graphname].pathData[pathname]
		}

		
		graphData = {}

		// darkmode = false
			
		uid = 0
		complexplane = document.getElementById('complexplane')
		graphoptions = {}
		graphoptions.xmax = 10
		graphoptions.xmin = -10
		graphoptions.ymax = 15
		graphoptions.ymin = -15
		graphoptions.axislocationX = 0
		graphoptions.axislocationY = 0
		graphoptions.xaxislabelvisibility = 'no'
		graphoptions.yaxislabelvisibility = 'no'
		graphoptions.ymajorgridlinesextension = 'yes'
		graphoptions.xmajorgridlinesextension = 'yes'
		graphoptions.fontSize = 2
		graphoptions.unitAspectRatio = 'yes'
		graphoptions.fixAxis = 'yaxis'
		graphoptions.fixAxisStretchCentrally = 'yes'
		graphoptions.isComplexPlane = 'yes'
		addGraph(complexplane, 'complexplanegraph', graphoptions)


		

		function setPlayerAt(valuechoice) {
			options = {}
			options.y1 = 0
			options.y2 = 0
			options.x1 = 0
			options.x2 = valuechoice

			updateLine('playlinegraph', 'playlineLinetop', options)
			updatePoint('playlinegraph', 'playlinepoint', valuechoice, 0)
		}


		function gridcolorX(val, minv, maxv) {
			return 190 + ((val - minv)*(260 - 190)/(maxv - minv))
		}

		function gridcolorY(val, minv, maxv) {
			return -10 + ((val - minv)*(80 - 0)/(maxv - minv))
		}


		

		// transformLines = []
		transformLinesMap = {}



		breakpointsnum = 200
		const breakdelta = 0.1
		functionmode = 'zeta'
		alltransformsMap = {}
		// transformpoints = {}


		function computeMidpoints() {
			alltransformsMap = {}
			totallines = Object.keys(transformLinesMap).length
			nupinput = parseInt(document.getElementById('nupperinput').value)
			nlowinput = parseInt(document.getElementById('nlowerinput').value)
			inputfunctiontext = functiontouse
			linenum = 0
			for (var key in transformLinesMap) {
				// console.log(linenum/totallines)
				options = {}
				options.w = (linenum/totallines)*120
				updateRectangle('computeprogressgraph', 'progressRect' , options)
				// document.getElementById('computebutton').innerHTML = (linenum/totallines)*120
				linenum = linenum + 1
				pts = transformLinesMap[key][1]
				for (k1 = 0; k1 < pts.length; k1++) {
					// console.log(pts[k1])
					segmentdata = totalSumSegments(pts[k1][0] + '+' + pts[k1][1] + 'i', nupinput, nlowinput, inputfunctiontext)
					sumvalue = segmentdata.Tsum
					mapvalue = [sumvalue.re, sumvalue.im]

					inbetweenTimesLocs = getdistancesattimes(pts[k1], mapvalue, 0, 100, 1)
					for (t1 = 0; t1 < inbetweenTimesLocs.length; t1++) {
						if (typeof alltransformsMap[inbetweenTimesLocs[t1][1]] == 'undefined') {
							alltransformsMap[inbetweenTimesLocs[t1][1]] = {}
						}

						if (typeof alltransformsMap[inbetweenTimesLocs[t1][1]][key] == 'undefined') {
							alltransformsMap[inbetweenTimesLocs[t1][1]][key] = [inbetweenTimesLocs[t1][0]]
						}
						else {
							alltransformsMap[inbetweenTimesLocs[t1][1]][key].push(inbetweenTimesLocs[t1][0])
						}
					}
				}
			}
			document.getElementById('pauseplay').innerHTML = 'Play'
			options = {}
			options.w = 0
			updateRectangle('computeprogressgraph', 'progressRect' , options)

		}

		stepvalue = 0

		lineKeys = Object.keys(transformLinesMap)

		function computeStepPrep() {
			alltransformsMap = {}
			lineKeys = Object.keys(transformLinesMap)
			nupinput = parseInt(document.getElementById('nupperinput').value)
			nlowinput = parseInt(document.getElementById('nlowerinput').value)
			inputfunctiontext = functiontouse
			// document.getElementById('computebutton').style.pointerEvents = 'none'
			document.getElementById('computebutton').innerHTML = 'Computing...'
			stepvalue = 0
			// document.getElementById('computebutton').removeEventListener('click', handlecompute)
			document.getElementById('computebutton').addEventListener('click', computeStepEnd)

			computeLoop()
		}

		function computeStepEnd() {
			document.getElementById('pauseplay').innerHTML = 'Play'
			options = {}
			options.w = 0
			// updateRectangle('computeprogressgraph', 'progressRect' , options)
			clearInterval(cloopinterval)
			// enableplayline()
			compute = false
			stepvalue = 0
			// document.getElementById('computebutton').addEventListener('click', handlecompute)
			document.getElementById('computebutton').removeEventListener('click', computeStepEnd)

			document.getElementById('computebutton').style.visibility = 'hidden'
			document.getElementById('computebutton').style.pointerEvents = 'none'
			document.getElementById('computebutton').style.zIndex = 0
			document.getElementById('computeholder').style.visibility = 'hidden'
			document.getElementById('computeholder').style.pointerEvents = 'none'
			document.getElementById('computeholder').style.zIndex = 0

			document.getElementById('computebutton').innerHTML = 'Compute Transform Animation'
		}
		

		function computeMidpointsStep(stepval) {
			// console.log(linenum/totallines)
			if (stepval < lineKeys.length) {
				options = {}
				options.w = (stepval/lineKeys.length)*120
				updateRectangle('computeprogressgraph', 'progressRect' , options)
				document.getElementById('computebutton').innerHTML = 'Computing... <font style="color: hsla(190, 100%, 50%, 1); font-size: 2vmin;">' + (stepval*100/lineKeys.length).toFixed(1) + '% done. </font> Click to cancel.'
			
				// document.getElementById('computebutton').innerHTML = (linenum/totallines)*120
				// linenum = linenum + 1
				key = lineKeys[stepval]
				pts = transformLinesMap[key][1]
				// console.log(pts[0])
				for (k1 = 0; k1 < pts.length; k1++) {
					// console.log(pts[k1])
					
					if (functionmode == 'sum') {
						segmentdata = totalSumSegments(pts[k1][0] + '+' + pts[k1][1] + 'i', nupinput, nlowinput, inputfunctiontext)
						sumvalue = segmentdata.Tsum
					}
					else if (functionmode == 'simple') {
						sumvalue = getFuncValue(pts[k1][0] + '+' + pts[k1][1] + 'i', inputfunctiontext)
					}
					else {
						sumvalue = zetaEMS(pts[k1][0] + '+' + pts[k1][1] + 'i', 50, 40)
					}

					mapvalue = [sumvalue.re, sumvalue.im]

					// console.log(pts[k1], mapvalue)

					inbetweenTimesLocs = getdistancesattimes(pts[k1], mapvalue, 0, 100, 1)
					for (t1 = 0; t1 < inbetweenTimesLocs.length; t1++) {
						if (typeof alltransformsMap[inbetweenTimesLocs[t1][1]] == 'undefined') {
							alltransformsMap[inbetweenTimesLocs[t1][1]] = {}
						}

						if (typeof alltransformsMap[inbetweenTimesLocs[t1][1]][key] == 'undefined') {
							alltransformsMap[inbetweenTimesLocs[t1][1]][key] = [inbetweenTimesLocs[t1][0]]
						}
						else {
							alltransformsMap[inbetweenTimesLocs[t1][1]][key].push(inbetweenTimesLocs[t1][0])
						}
					}
				}
			}
			else {
				computeStepEnd()
			}	
		}




		function displayGAt(timeval) {
			locations = alltransformsMap[timeval]
			for (var key in locations) {
				// console.log(key)
				// console.log(locations[key])
				updatePath('complexplanegraph', key, locations[key])
			}
		}






		function ordinal_suffix_of(i) {
			// Code from https://stackoverflow.com/questions/13627308/add-st-nd-rd-and-th-ordinal-suffix-to-a-number 

			var j = i % 10;
			k = i % 100;
			if (j == 1 && k != 11) {
				return i + "st";
			}
			if (j == 2 && k != 12) {
				return i + "nd";
			}
			if (j == 3 && k != 13) {
				return i + "rd";
			}
			return i + "th";
		}



		function oversegmentEvent(event) {
			termdata = termsegmentmap[event.target.id]
			if (termdata[1].im > 0) {
				textinfo = '<tspan x="0" dy="1.2em">It is the ' + ordinal_suffix_of(termdata[0])  + ' term of the summation </tspan><tspan x="0" dy="1.2em">with value ' + termdata[1].re + ' + ' + Math.abs(termdata[1].im) + ' i</tspan>'
			}
			else {
				textinfo = '<tspan x="0" dy="1.2em">It is the ' + ordinal_suffix_of(termdata[0])  + ' term of the summation </tspan><tspan x="0" dy="1.2em">with value ' + termdata[1].re + ' - ' + Math.abs(termdata[1].im) + ' i</tspan>'	
			}

			// options = {}
			// options.text = textinfo
			// textposdata = updateText('complexplanegraph', 'segmentoverhighlight', options)

			var bRect = document.getElementById('complexplanegraph').getBoundingClientRect();
			posX = event.clientX - bRect.left;
			posY = event.clientY - bRect.top;
			gratio = graphData['complexplanegraph'].aspectratio

			if (gratio > 1) {
				posX = (posX/bRect.width)*100
				posX = ((posX - 50)*gratio + 50)
				posY = (posY/bRect.height)*100

			}
			else {
				posX = (posX/bRect.width)*100
				posY = (posY/bRect.height)*100
				posY = ((posY - 50)/gratio + 50)
				
			}

			// textposdata[0].setAttribute('x', posX)
			// textposdata[0].setAttribute('y', posY)
		}




		termsegmentmap = {}

		// functionmode = 'simple'


		function deleteSegments(collection) {
			if (typeof collection != 'undefined') {
				for (f = 0; f < collection.length; f++) {
					collection[f].outerHTML = ''
				}
			}
		}

		function deleteSegmentLines(collection) {
			if (typeof collection != 'undefined') {
				for (f = 0; f < collection.length; f++) {
					removeLine('complexplanegraph', collection[f])
				}
			}
		}

		functiontouse = document.getElementById('inputfunctiontext').value


		// Problem : No complete deletion

		window.onload = function() {
			
			nupinput = parseInt(document.getElementById('nupperinput').value)
			nlowinput = parseInt(document.getElementById('nlowerinput').value)
			inputfunctiontext = document.getElementById('inputfunctiontext').value

			// console.log(math.parse(inputfunctiontext).toTex())
			if (functionmode == 'zeta') {
				document.getElementById('equationdisplay').innerHTML = " $$ \vec { \mathbf { v } } = \frac { d \vec { \mathbf { r } } } { d t } = v _ { x } \hat { \mathbf { i } } + v _ { y } \hat { \mathbf { j } } + v _ { z } \hat { \mathbf { k } } $$"
				document.getElementById("functionzeta").click();
			}

			// computeStepPrep()
					
		};




		function inputChange(event) {
			nupinput = parseInt(document.getElementById('nupperinput').value)
			nlowinput = parseInt(document.getElementById('nlowerinput').value)
			inputfunctiontext = document.getElementById('inputfunctiontext').value

			// document.getElementById('pauseplay').innerHTML = 'Compute'
			compute = true
			disableplayline()
			finalcheckdone = false
			document.getElementById('computebutton').style.visibility = 'visible'
			document.getElementById('computebutton').style.pointerEvents = 'auto'
			document.getElementById('computebutton').style.zIndex = 5
			document.getElementById('computeholder').style.visibility = 'visible'
			document.getElementById('computeholder').style.pointerEvents = 'auto'
			document.getElementById('computeholder').style.zIndex = 4

			// console.log('check')
			if (functionmode == 'sum') {
				try {
					document.getElementById('equationdisplay').innerHTML = " $$ f(z) =  \\sum_{n=" +  nlowinput + "}^{m=" +  nupinput + "} " + math.parse(inputfunctiontext).toTex() + " $$"
					document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(0, 0, 0, 0)'
					functiontouse = inputfunctiontext
				}
				catch(err) {
					if (darkmode) {
						document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(255, 0, 0, 0.4)'
					}
					else {
						document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(255, 0, 0, 0.1)'
					}
					displayText('Not a valid input expression.')
				}
					
			}
			else if (functionmode == 'simple') {
				try {
					while (inputfunctiontext.indexOf('n') != -1) {
						inputfunctiontext = inputfunctiontext.replace('n', '1')
					}
					document.getElementById('inputfunctiontext').value = inputfunctiontext
					document.getElementById('equationdisplay').innerHTML = " $$ f(z) = " + math.parse(inputfunctiontext).toTex() + "$$"
					document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(0, 0, 0, 0)'
					functiontouse = inputfunctiontext
				}
				catch(err) {
					if (darkmode) {
						document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(255, 0, 0, 0.4)'
					}
					else {
						document.getElementById('inputfunctiontext').style.backgroundColor = 'rgba(255, 0, 0, 0.1)'
					}
					displayText('Not a valid input expression.')
				}
				
			}

			else if (functionmode == 'zeta') {
				document.getElementById('equationdisplay').innerHTML = " $$ f(z) =  \\sum_{n=1}^{m=\\infty} \\frac{1}{n^z} $$"
			}
			
			MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
			
		}



		document.getElementById('inputfunctiontext').addEventListener('input', inputChange)
		document.getElementById('nupperinput').addEventListener('input', inputChange)
		document.getElementById('nlowerinput').addEventListener('input', inputChange)

		

		function getFuncValue(zval, etext) {
			expr = etext
			let scope = {z:math.complex(zval), n:1}
			evaluated = math.complex(math.eval(expr, scope))
			// console.log(nval, zval)
			// console.log(evaluated)
			return evaluated
		}


		function nthTerm(nval, zval, etext) {
			expr = etext
			let scope = {z:math.complex(zval), n:nval}
			evaluated = math.complex(math.eval(expr, scope))
			// console.log(nval, zval)
			// console.log(evaluated)
			return evaluated
		}

		function totalSum(zv, nup, nlow, inputexpr) {
			totalsumvalue = math.eval('0')
			for (nv = nlow; nv <= nup; nv++) {
				nthtermvalue = nthTerm(nv, zv, inputexpr)
				totalsumvalue = math.add(totalsumvalue, nthtermvalue)
			}
			// console.log('Total : ')
			// console.log(totalsumvalue)
			return totalsumvalue
		}

		function totalSumSegments(zv, nup, nlow, inputexpr) {
			sum = {}
			sum.segments = []
			sum.termSum = []
			totalsumvalue = math.eval('0+0i')
			sum.maxmagnitude = 0
			sum.polarValues = []
			sum.maxtermnumber = 0
			for (nv = nlow; nv <= nup; nv++) {
				nthtermvalue = nthTerm(nv, zv, inputexpr)
				sum.termSum.push(nthtermvalue)
				segment = [totalsumvalue]
				totalsumvalue = math.add(totalsumvalue, nthtermvalue)
				segment.push(totalsumvalue)
				sum.segments.push(segment)
				polarval = nthtermvalue.toPolar()
				sum.polarValues.push(polarval)
				magnitude = polarval.r
				if (magnitude > sum.maxmagnitude) {
					sum.maxmagnitude = magnitude
					sum.maxtermnumber = nv
				}
			}
			// console.log('Total : ')
			// console.log(totalsumvalue)
			sum.Tsum = totalsumvalue
			return sum
		}


		// totalSum('2+4i', nupinput, nlowinput, inputfunctiontext)

		function checkPointOfGrid(pt) {
			raiseflag = 0
			for (f = 0; f < gridXlinesValues.length; f++) {
				if (Math.abs(pt[0] - gridXlinesValues[f]) < plotdelta) {
					raiseflag = 1
					break
				}
			}
			if (raiseflag == 0) {
				for (f = 0; f < gridYlinesValues.length; f++) {
					if (Math.abs(pt[1] - gridYlinesValues[f]) < plotdelta) {
						raiseflag = 1
						break
					}
				}
			} 

			if (raiseflag == 1) {
				return true
			}
			else {
				return false
			}
		}


		// gridXlines = graphData['complexplanegraph'].xmajorgridElements
		gridXlinesValues = graphData['complexplanegraph'].xmajorgridticks

		// gridYlines = graphData['complexplanegraph'].ymajorgridElements
		gridYlinesValues = graphData['complexplanegraph'].ymajorgridticks

		plotdelta = 0.1

		

		plotcanvas = document.getElementById('plotcanvas')
		plotcanvas.width = document.getElementById('complexplane').offsetWidth
		plotcanvas.height = document.getElementById('complexplane').offsetHeight
		plotcanvas.style.width = plotcanvas.width
		plotcanvas.style.height = plotcanvas.height


		// console.log()

		function colorPoint(loc, truth) {

			// var rect = plotcanvas

			asratio = graphData['complexplanegraph'].aspectratio 
			gymin = graphData['complexplanegraph'].ymin
			gymax = graphData['complexplanegraph'].ymax
			gxmin = graphData['complexplanegraph'].xmin
			gxmax = graphData['complexplanegraph'].xmax
			// console.log(gxmax, gxmin)

			gx = graphToScaledX(loc[0], gxmin, gxmax, asratio)
			gy = graphToScaledY(loc[1], gymin, gymax, asratio)

			
			context = plotcanvas.getContext("2d");
			// context.canvas.width = 100;
  			context.canvas.height = 100;
  
			
			posxP = gx*document.getElementById('complexplane').offsetWidth/100
			posyP = gy*document.getElementById('complexplane').offsetHeight/100

			// console.log(posxP, posyP)

			if (truth) {
				context.fillStyle = 'hsla(10,100%,50%,1)'
				context.strokeStyle = 'rgba(2,24,255,1)';
			}
			else {
				context.fillStyle = 'hsla(190,100%,50%,1)'
				context.strokeStyle = 'rgba(2,24,255,1)';
			}


			context.beginPath();
			context.arc(posxP, posyP, 2, 0, 2 * Math.PI);
			context.fill();
			
		}

		looptime = 0
		loopinterval = ''

		function playLoop(event) {
			loopinterval = setInterval(frame, 50);
			function frame() {
				looptime = looptime + 1
				displayGAt(looptime)
				setPlayerAt(looptime)
				// console.log(looptime)
				if (looptime == 99) {
					clearInterval(loopinterval);
					looptime = 0
				}
				
			}
		}


		function computeLoop(event) {
			cloopinterval = setInterval(frame2, 1);
			function frame2() {
				computeMidpointsStep(stepvalue)
				stepvalue = stepvalue + 1
			}
		}



		function changetoZeta(event) {
			functionmode = 'zeta'
			// console.log(darkmode)
			if (darkmode == false) {
				event.target.style.color = 'hsla(190, 100%, 50%, 1)'
				event.target.style.backgroundColor = 'hsla(190, 100%, 100%, 0)'
				event.target.style.borderBottom = '0px solid hsla(190, 100%, 100%, 0)'
				// document.getElementById('functionsimple').style.color = 'hsla(190, 0%, 0%, 1)'
				// document.getElementById('functionsimple').style.backgroundColor = 'hsla(190, 0%, 50%, 0.1)'
				// document.getElementById('functionsimple').style.borderBottom = '1px solid hsla(190, 0%, 0%, 1)'
				// document.getElementById('functionsummation').style.color = 'hsla(190, 0%, 0%, 1)'
				// document.getElementById('functionsummation').style.backgroundColor = 'hsla(190, 0%, 50%, 0.1)'
				// document.getElementById('functionsummation').style.borderBottom = '1px solid hsla(190, 0%, 0%, 1)'
			}
			document.getElementById('nlowertext').style.visibility = 'hidden'
			document.getElementById('nlowervalue').style.visibility = 'hidden'
			document.getElementById('nuppertext').style.visibility = 'hidden'
			document.getElementById('nuppervalue').style.visibility = 'hidden'
			document.getElementById('summationtitle').style.visibility = 'hidden'
			document.getElementById('inputfunction').style.visibility = 'hidden'

			document.getElementById('displayforZetaH').style.visibility = 'visible'

			
			// document.getElementById('summationtitle').innerHTML = 'Summation Term'
			document.getElementById('spectrumholder').style.visibility = 'hidden'
			// document.getElementById('ntermdisplayHold').style.visibility = 'hidden'

		    if (functionmode == 'zeta') {
				document.getElementById('equationdisplay').innerHTML = " $$ \\vec { \\mathbf { r } } = x \\hat { \\mathbf { i } } + y \\hat { \\mathbf { j } } + z \\hat { \\mathbf { k } }  $$"
			}

			MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
				}


		document.getElementById('functionzeta').addEventListener('click', changetoZeta)

		math.config({
			number: 'BigNumber', // Default type of number: 
			// 'number' (default), 'BigNumber', or 'Fraction'
			precision: 64        // Number of significant digits for BigNumbers
		})

		function projectile(V_A, theta, time) {
			
			V_Ax =  V_A * math.cos(theta/180*Math.PI)
			V_Ay =  V_A * math.sin(theta/180*Math.PI)

			S_x  = V_Ax * time
			S_y  = V_Ay * time - 1/2*32.2* math.pow(time,2)
			return [S_x,S_y]

		}

		circleoptions= {}
		circleoptions.x = 15
		circleoptions.y = -9
		circleoptions.radius = 0.5
		addCircle("complexplanegraph", "strike", circleoptions) 


		criticalZetaValues = {}
		pclooptime = 0
		pclinecollection = []

		const plotcriticallinedelta = breakdelta*0.01

		function plotCriticalLine(step) {
			time = step*plotcriticallinedelta
			// zetavalue = zetaEMS('0.5+' + time + 'i', 50, 40)
			// criticalZetaValues[time] = [zetavalue.re, zetavalue.im]
			var V_A= document.getElementById('initialVA').value
			var v_a =  parseFloat(V_A)
			var theta = parseFloat(document.getElementById('initialtheta').value)
			position = projectile(v_a,theta,time)
			criticalZetaValues[time] = [position[0], position[1]]
			if (step == 0) {
				prevzeta = criticalZetaValues[(step - 1)*plotcriticallinedelta]
				currentzeta = criticalZetaValues[time]
			}
			else if (step == 1) {
				prevzeta = criticalZetaValues[(step - 1)*plotcriticallinedelta]
				currentzeta = criticalZetaValues[time]
			}
			else {
				prevzeta = criticalZetaValues[(step - 1)*plotcriticallinedelta]
				currentzeta = criticalZetaValues[time]

				options = {}
				options.points = [currentzeta, prevzeta]
				options.pathcolor = 'hsla(40, 100%, 50%, 0.9)'
				options.strokewidth = 0.2
				// console.log(time)
				pathdata = addPath('complexplanegraph', time + '-criticalZeta', options)
				// updatePoint('complexplanegraph', 'plotcpoint', currentzeta[0], currentzeta[1])
				// updatePoint('complexplanegraph', 'plotcinputpoint', 0.5, time)
				pclinecollection.push(time + '-criticalZeta')
			}
				
		}

		function reprocessPlotC(event) {
			clearInterval(loopintervalpc);
			pclooptime = 0
			pcloopcancel = false
			// deleteMeshlines(pclinecollection)
			pclinecollection = []
			document.getElementById('plotcriticalline').removeEventListener('click', reprocessPlotC)
			document.getElementById('plotcriticalline').addEventListener('click', processPlotC)
			// document.getElementById('plotcriticalline').innerHTML = 'Plot Zeta along Critical Line'

			// addedptcritical.style.visibility = 'hidden'
			// addedptcriticalinput.style.visibility = 'hidden'
		}

		function processPlotC(event) {
			playPlotC()
			pcloopcancel = false
			document.getElementById('plotcriticalline').removeEventListener('click', processPlotC)
			document.getElementById('plotcriticalline').addEventListener('click', reprocessPlotC)
			document.getElementById('plotcriticalline').innerHTML = 'Cancel Plot'

			// addedptcritical.style.visibility = 'visible'
			// addedptcriticalinput.style.visibility = 'visible'
		}

		pclooptime = 0
		function playPlotC(event) {
			loopintervalpc = setInterval(framepc, 1);
			function framepc() {
				pclooptime = pclooptime + 1
				plotCriticalLine(pclooptime)
				document.getElementById('plotcriticalline').innerHTML = '<font style="color:hsla(190, 100%, 50%, 1); font-size:2vmin;">at ' + (pclooptime*plotcriticallinedelta).toFixed(1) + ' seconds </font> Click to Cancel..'
				if (pcloopcancel == true) {
					clearInterval(loopintervalpc);
					pclooptime = 0
					pcloopcancel = false
				}
				
			}
		}


		document.getElementById('plotcriticalline').addEventListener('click', processPlotC)



		</script>


	</body>
<html>
